<!DOCTYPE html>
<html ng-app="countryApp" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular-route.min.js"></script>
    <script>
        var countryApp = angular.module('countryApp', ['ngRoute']);

        countryApp.config(function ($routeProvider) {
            $routeProvider
                    .when('/', {
                        templateUrl: 'country-list.html',
                        controller: 'CountryListCtrl'
                    })
                    .when('/:countryName', {
                        templateUrl: 'country-detail.html',
                        controller: 'CountryDetailCtrl'
                    })
                    .otherwise({
                        redirectTo: '/'
                    })
        });

        countryApp.factory('countries', function ($http) {

            var cachedData;

            function getData(callback) {
                if (cachedData) {
                    callback(cachedData);
                } else {
                    $http.get('countries.json').success(function (data) {
                        cachedData = data;
                        callback(data);
                    });
                }
            }

            return {
                list: getData,
                find: function (name, callback) {
                    getData(function (data) {
                        var country = data.filter(function (entry) {
                            return entry.name === name;
                        })[0];
                        callback(country);
                    });
                }
            };
        });

        countryApp.controller('CountryListCtrl', ['$scope', 'countries', function (scope, countries) {
            countries.list(function (data) {
                scope.countries = data;
            });
        }]);

        countryApp.controller('CountryDetailCtrl', function ($scope, $routeParams, countries) {
            countries.find($routeParams.countryName, function (country) {
                $scope.country = country;
            });

        });
    </script>
    <!--<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>-->
    <!--<script src="http://jashkenas.github.io/underscore/underscore-min.js"></script>-->
    <!--<script src="http://jashkenas.github.io/backbone/backbone-min.js"></script>-->
</head>
<body>
<div ng-view>

</div>
<!--<script>-->
<!--//Model-->
<!--var model = new Backbone.Model({-->
<!--name : ''-->
<!--});-->

<!--//View-->
<!--model.on('change:name', function(){-->
<!--$('#nameSpan').html(model.get('name'));-->
<!--});-->

<!--//Controller-->
<!--$('#textInput').on('keyup',function () {-->
<!--model.set('name', $('#textInput').val())-->
<!--});-->

<!--</script>-->
</body>
</html>